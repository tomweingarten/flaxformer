# "Experts choose tokens" MoE Small model.
# Provides MODEL

include 'flaxformer/t5x/configs/moe/models/experts_choose_base.gin'

# Architecture overrides
NUM_ENCODER_LAYERS = 6
NUM_DECODER_LAYERS = 6
NUM_HEADS = 8
HEAD_DIM = 64
EMBED_DIM = 512
MLP_DIM = 2048

# MoE overrides
# Replace every other dense MLP sublayer with MoE sublayer.
NUM_ENCODER_SPARSE_LAYERS = 3
NUM_DECODER_SPARSE_LAYERS = 3
